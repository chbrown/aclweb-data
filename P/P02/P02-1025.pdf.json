{"sections":[{"title":"A Study on Richer Syntactic Dependencies for Structured Language Modeling Peng Xu Center for Language and Speech Processing Johns Hopkins University Baltimore, MD 21218 xp@clsp.jhu.edu Ciprian Chelba Microsoft Research One Microsoft Way Redmond, WA 98052 chelba@microsoft.com Frederick Jelinek Center for Language and Speech Processing Johns Hopkins University Baltimore, MD 21218 jelinek@clsp.jhu.edu Abstract","paragraphs":["We study the impact of richer syntactic dependencies on the performance of the structured language model (SLM) along three dimensions: parsing accuracy (LP/LR), perplexity (PPL) and word-error-rate (WER, N-best re-scoring). We show that our models achieve an improvement in LP/LR, PPL and/or WER over the reported baseline results using the SLM on the UPenn Treebank and Wall Street Journal (WSJ) corpora, respectively. Analysis of parsing performance shows correlation between the quality of the parser (as measured by precision/recall) and the language model performance (PPL and WER). A remarkable fact is that the enriched SLM outperforms the baseline 3-gram model in terms of WER by 10% when used in isolation as a second pass (N-best re-scoring) language model."]},{"title":"1 Introduction","paragraphs":["The structured language model uses hidden parse trees to assign conditional word-level language model probabilities. As explained in (Chelba and Jelinek, 2000), Section 4.4.1, if the final best parse is used to be the only parse, the reduction in PPL —relati ve to a 3-gram baseline— using the SLM’s headword parametrization for word prediction is about 40%. The key to achieving this reduction is a good guess of the finalbest parse for a given sentence as it is being traversed left-to-right, which is much harder than findingthe finalbest parse for the entire sentence, as it is sought by a regular statistical parser. Nevertheless, it is expected that techniques developed in the statistical parsing community that aim at recovering the best parse for an entire sentence, i.e. as judged by a human annotator, should also be productive in enhancing the performance of a language model that uses syntactic structure.","The statistical parsing community has used various ways of enriching the dependency structure underlying the parametrization of the probabilistic model used for scoring a given parse tree (Charniak, 2000) (Collins, 1999). Recently, such models (Charniak, 2001) (Roark, 2001) have been shown to outperform the SLM in terms of both PPL and WER on the UPenn Treebank and WSJ corpora, respectively. In (Chelba and Xu, 2001), a simple way of enriching the probabilistic dependencies in the CONSTRUCTOR component of the SLM also showed better PPL and WER performance; the simple modifica-tion to the training procedure brought the WER performance of the SLM to the same level with the best as reported in (Roark, 2001).","In this paper, we present three simple ways of enriching the syntactic dependency structure in the SLM, extending the work in (Chelba and Xu, 2001). The results show that an improved parser (as measured by LP/LR) is indeed helpful in reducing the PPL and WER. Another remarkable fact is that for the first time a language model exploiting elemen-Computational Linguistics (ACL), Philadelphia, July 2002, pp. 191-198. Proceedings of the 40th Annual Meeting of the Association for tary syntactic dependencies obviates the need for interpolation with a 3-gram model in N-best re-scoring."]},{"title":"2 SLM Review","paragraphs":["An extensive presentation of the SLM can be found in (Chelba and Jelinek, 2000). The model assigns a probability  to every sentence  and every possible binary parse  . The terminals of  are the words of  with POS tags, and the nodes of ","are annotated with phrase headwords and non-terminal labels. Let  be a sentence of length (<s>, SB) ....... (w_p, t_p) (w_{p+1}, t_{p+1}) ........ (w_k, t_k) w_{k+1}.... </s> h_0 = (h_0.word, h_0.tag)h_{-1}h_{-m} = (<s>, SB)","Figure 1: A word-parse -prefix words to which we have prepended the sentence beginning marker <s> and appended the sentence end marker </s> so that","<s> and","</s>. Let "," ","  be the word","-prefix of the","sentence — the words from the beginning of the","sentence up to the current position","— and  the word-parse","-prefix. Figure 1 shows a word-parse","-prefix; h_0, .., h_{-m} are the exposed heads, each head being a pair (headword, non-terminal label), or (word, POS tag) in the case of a root-only tree. The exposed heads at a given position","in the input sentence are a function of the word-parse","-prefix. 2.1 Probabilistic Model The joint probability  of a word sequence  and a complete parse  can be broken up into:","  ","","","","","","","","","","  ","","","","","","","","","","","","","","","","","","","","","   ","","","","","","","","","","     "," (1)","where:     is the word-parse   ","-prefix  ","is the word predicted by WORD-PREDICTOR  is the tag assigned to ","by the TAGGER ","","is the number of operations the CON-","STRUCTOR executes at sentence position","before ............... T’_0","T_{-1} T_0 <s> T’_{-1}<-T_{-2} h_{-1} h_0 h’_{-1} = h_{-2} T’_{-m+1}<-<s> h’_0 = (h_{-1}.word, NTlabel) Figure 2: Result of adjoin-left under NT label","............... T’_{-1}<-T_{-2} T_0 h_0h_{-1} <s> T’_{-m+1}<-<s> h’_{-1}=h_{-2} T_{-1} h’_0 = (h_0.word, NTlabel) Figure 3: Result of adjoin-right under NT label","passing control to the WORD-PREDICTOR (the ","-th operation at position k is the null transi-tion);   is a function of "," ","","denotes the","-th CONSTRUCTOR operation carried out at position k in the word string; the operations performed by the CONSTRUCTOR are illustrated in Figures 2-3 and they ensure that all possible binary branching parses, with all possible headword and non-terminal label assignments for the ",""," ","word sequence, can be generated. The        sequence of CONSTRUCTOR operations","at position","grows the word-parse    -prefixinto a word-parse","-prefix.","The SLM is based on three probabilities, each estimated using deleted interpolation and parameterized (approximated) as follows:","","","","  ","",""," ","","   ",""," (2)","","","","    ","","","",""," ","","","","   ","","","",""," (3)","","    ","","",""," ","","","","  ","","","",""," (4) It is worth noting that if the binary branching structure developed by the parser were always right-branching and we mapped the POS tag and non-terminal label vocabularies to a single type, then our model would be equivalent to a trigram language model. Since the number of parses for a given word prefix ","grows exponentially with ,","","","","  ",", the state space of our model is huge even for relatively short sentences, so we have to use a search strategy that prunes it. One choice is a synchronous multi-stack search algorithm which is very similar to a beam search.","The language model probability assignment for","the word at position","","","in the input sentence is","made using:","","","","","  ","","","","  ","","","","","","","","   ","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""," (5) which ensures a proper probability normalization over strings   , where ","is the set of all parses present in our stacks at the current stage",".","Each model component —W ORD-PREDICTOR, TAGGER, CONSTRUCTOR— is initialized from a set of parsed sentences after undergoing headword percolation and binarization, see Section 2.2. An N-best EM (Dempster et al., 1977) variant is then employed to jointly reestimate the model parameters such that the PPL on training data is decreased — the likelihood of the training data under our model is increased. The reduction in PPL is shown experimentally to carry over to the test data. 2.2 Headword Percolation And Binarization As explained in the previous section, the SLM is initialized on parse trees that have been binarized and the non-terminal (NT) tags at each node have been enriched with headwords. We will briefly review the headword percolation and binarization procedures; they are explained in detail in (Chelba and Jelinek, 2000).","The position of the headword within a constituent — equivalent to a context-free production of the type     , where         are NT labels or POS tags (only for   ) — is specified using a rule-based approach.","Assuming that the index of the headword on the right-hand side of the rule is",", we binarize the constituent as follows: depending on the ","identity we apply one of the two binarization schemes in Figure 4. The intermediate nodes created by the above binarization schemes receive the NT label"," 1",". The choice among the two schemes is made according to a list of rules based on the identity of the label on the left-hand-side of a CF rewrite rule."]},{"title":"3 Enriching Syntactic Dependencies","paragraphs":["The SLM is a strict left-to-right, bottom-up parser, therefore in Eq.( 2, 3, 4) the probabilities are con-1","Any resemblance to X-bar theory is purely coincidental. Z Z’ Z’ Z’ B Z Z’ Z’ Z’ A Y_1 Y_k Y_n Y_1 Y_k Y_n Figure 4: Binarization schemes ditioned on the left contextual information. There are two main reasons we prefer strict left-to-right parsers for the purpose of language modeling (Roark, 2001):"," when looking for the most likely word string given the acoustic signal (as required in a speech recognizer), the search space is organized as a prefixtree. A language model whose aim is to guide the search must thus operate left-to-right.  previous results (Chelba and Jelinek, 2000) (Charniak, 2001) (Roark, 2001) show that a grammar-based language model benefits from interpolation with a 3-gram model. Strict left-to-right parsing makes it easy to combine with a standard 3-gram at the word level (Chelba and Jelinek, 2000) (Roark, 2001) rather than at sentence level (Charniak, 2001). For these reasons, we prefer enriching the syntactic dependencies by information from the left context.","However, as mentioned in (Roark, 2001), one way of conditioning the probabilities is by annotat-ing the extra conditioning information onto the node labels in the parse tree. We can annotate the training corpus with richer information and with the same SLM training procedure we can estimate the probabilities under the richer syntactic tags. Since the treebank parses allow us to annotate parent information onto the constituents, as Johnson did in (Johnson, 1998), this richer predictive annotation can extend information slightly beyond the left context.","Under the equivalence classification in Eq.( 2, 3, 4), the conditional information available to the SLM model components is made up of the two most-recent exposed heads consisting of two NT tags and two headwords. In an attempt to extend the syntactic dependencies beyond this level, we enrich the non-terminal tag of a node in the binarized parse tree with the NT tag of the parent node, or the NT tag of the child node from which the headword is not being percolated (same as in (Chelba and Xu, 2001)), or we add the NT tag of the third most-recent exposed head to the history of the CONSTRUCTOR component. The three ways are briefly described as:","1. opposite (OP): we use the non-terminal tag of the child node from which the headword is not being percolated","2. parent (PA): we use the non-terminal tag of the parent node to enrich the current node","3. h-2: we enrich the conditioning information","of the CONSTRUCTOR with the non-terminal","tag of the third most-recent exposed head, but","not the headword itself. Consequently, Eq. 4","becomes","","","","","","","    ","","","","","","","","","","","","     We take the example from (Chelba and Xu, 2001)","to illustrate our enrichment approaches. Assume","that after binarization and headword percolation, we","have a noun phrase constituent:","(NP_group (DT the) (NP’_group","(NNP dutch)","(NP’_group (VBG publishing)","(NN group)))),","which, after enriching the non-terminal tags using","the opposite and parent scheme, respectively, be-","comes","(NP+DT_group (DT the) (NP’+NNP_group","(NNP dutch)","(NP’+VBG_group (VBG publishing)","(NN group))))","and2","(NP+*_group (DT+NP the) (NP’+NP_group","(NNP+NP’ dutch)","(NP’+NP’_group (VBG+NP’ publishing)","(NN+NP’ group)))). 2 The NP+* has not been enriched yet because we have not","specified the NT tag of the parent of the NP group","A given binarized tree is traversed recursively in depth-first order and each constituent is enriched in the parent or opposite manner or both. Then from the resulting parse trees, all three components of the SLM are initialized and N-best EM training can be started.","Notice that both parent and opposite affect all three components of the SLM since they change the NT/POS vocabularies, but h-2 only affects the CONSTRUCTOR component. So we believe that if h-2 helps in reducing PPL and WER, it’s because we have thereby obtained a better parser. We should also notice the difference between parent and opposite in the bottom-up parser. In opposite scheme, POS (part of speech) tags are not enriched. As we parse the sentence, two most-recent exposed heads will be adjoined together under some enriched NT label (Figure 2, 3), the NT label has to match the NT tag of the child node from which the headword is not being percolated. Since the NT tags of the children are already known at the moment, the opposite scheme actually restricts the possible NT labels. In the parent scheme, POS tags are also enriched with the NT tag of the parent node. When a POS tag is predicted from the TAGGER, actually both the POS tag and the NT tag of the parent node are hypothesized. Then when two most recent exposed heads are adjoined together under some enriched NT label, the NT label has to match the parent NT information carried in both of the exposed heads. In other words, if the two exposed heads bear different information about their parents, they can never be adjoined. Since this restriction of adjoin movement is very tight, pruning may delete some or all the good parsing hypotheses early and the net result may be later development of inadequate parses which lead to poor language modeling and poor parsing performance.","Since the SLM parses sentences bottom-up while the parsers used in (Charniak, 2000), (Charniak, 2001) and (Roark, 2001) are top-down, it’s not clear how to find a direct correspondence between our schemes of enriching the dependency structure and the ones employed above. However, it is their “pick-and-choose” strategy that inspired our study of richer syntactic dependencies for the SLM. Model Word NT POS Parser baseline & h-2 10001 54 40 163 PA & h-2+PA 10001 570 620 1711 OP & h-2+OP 10001 970 40 2863 OP+PA & h-2+OP+PA 10001 3906 620 11719 Table 1: Vocabulary size comparison of the models"]},{"title":"4 Experiments","paragraphs":["With the three enrichment schemes described in Section 3 and their combinations, we evaluated the PPL performance of the resulting seven models on the UPenn Treebank and the WER performance on the WSJ setup, respectively. In order to see the correspondence between parsing accuracy and PPL/WER performance, we also evaluated the labeled precision and recall statistics (LP/LR, the standard parsing accuracy measures) on the UPenn Treebank corpus. For every model component in our experiments, deleted-interpolation was used for smooth-ing. The interpolation weights were estimated from separate held-out data. For example, in the UPenn Treebank setup, we used section 00-20 as training data, section 21-22 as held-out data, and section 23-24 as test data. 4.1 Perplexity We have evaluated the perplexity of the seven different models, resulting from applying parent, opposite, h-2 and their combinations. For each way of initializing the SLM we have performed 3 iterations of N-best EM training. The SLM is interpolated with a 3-gram model, built from exactly the same training data and word vocabulary, using a fixed interpolation weight. As we mentioned in Section 3, the NT/POS vocabularies for the seven models are different because of the enrichment of NT/POS tags. Table 1 shows the actual vocabulary size we used for each model (for parser, the vocabulary is a list of all possible parser operations). The baseline model is the standard SLM as described in (Chelba and Jelinek, 2000).","The PPL results are summarized in Table 2. The SLM is interpolated with a 3-gram model as shown in the equation:    ","","","","   ","","","","","      ","       Model Iter","=0.0","=0.4 baseline 0 167.4 151.9 baseline 3 158.7 148.7 PA 0 187.6 154.5 PA 3 164.5 149.5 OP 0 157.9 147.0 OP 3 151.2 144.2 OP+PA 0 185.2 152.1 OP+PA 3 162.2 147.3 h-2 0 161.4 149.2 h-2 3 159.4 148.2 h-2+PA 0 163.7 144.7 h-2+PA 3 160.5 143.9 h-2+OP 0 154.8 145.1 h-2+OP 3 153.6 144.4 h-2+OP+PA 0 165.7 144.1 h-2+OP+PA 3 165.4 143.8 Table 2: SLM PPL results Model","Iter=0 Iter=3","LP LR LP LR baseline 69.22 61.56 69.01 57.82 PA 79.84 45.46 81.20 39.52 OP 74.55 62.97 72.54 59.76 OP+PA 82.58 45.57 83.62 39.54 h-2 73.72 72.27 73.24 71.13 h-2+PA 75.59 70.93 74.93 70.56 h-2+OP 76.91 73.89 76.11 72.65 h-2+OP+PA 78.35 66.04 77.73 64.95 Table 3: Labeled precision/recall(%) results","We should note that the PPL result of the 3-gram model is 166.6. As we can see from the table, without interpolating with the 3-gram, the opposite scheme performed the best, reducing the PPL of the baseline SLM by almost 5% relative. When the SLM is interpolated with the 3-gram, the h-2+opposite+parent scheme performed the best, reducing the PPL of the baseline SLM by 3.3%. However, the parent and opposite+parent schemes are both worse than the baseline, especially before the EM training and with ","=0.0. We will discuss the results further in Section 4.4. 4.2 Parsing Accuracy Evaluation Table 3 shows the labeled precision/recall accuracy results. The labeled precision/recall results of our model are much worse than those reported in (Charniak, 2001) and (Roark, 2001). One of the reasons is that the SLM was not aimed at being a parser, but rather a language model. Therefore, in the search algorithm, the end-of-sentence symbol","Model Iter  ","0.0 0.2 0.4 0.6 0.8 1.0 baseline 0 13.0 13.1 13.1 13.1 13.0 13.4 13.7 PA 0 13.0 13.1 13.1 12.9 12.9 13.1 13.7 OP 0 12.8 12.7 12.8 12.8 12.7 13.1 13.7 OP+PA 0 13.1 13.3 12.9 13.0 12.9 13.1 13.7 h-2 0 12.5 12.7 12.5 12.6 12.9 13.2 13.7 h-2+ PA 0 12.7 12.8 13.0 12.7 12.7 13.0 13.7 h-2+ OP 0 12.3 12.3 12.4 12.6 12.7 12.8 13.7 h-2+ OP+ PA 0 12.6 12.6 12.4 12.5 12.7 12.9 13.7 Table 4: N-best re-scoring WER(%) results can be predicted before the parse of the sentence is ready for completion3",", thus completing the parse with a series of special CONSTRUCTOR moves (see (Chelba and Jelinek, 2000) for details). The SLM allows right-branching parses which are not seen in the UPenn Treebank corpus and thus the evaluation against the UPenn Treebank is inherently biased.","It can also be seen that both the LP and the LR dropped after 3 training iterations: the N-best EM variant used for SLM training algorithm increases the likelihood of the training data, but it cannot guarantee an increase in LP/LR, since the re-estimation algorithm does not explicitly use parsing accuracy as a criterion. 4.3 N-best Re-scoring Results To test our enrichment schemes in the context of speech recognition, we evaluated the seven models in the WSJ DARPA’93 HUB1 test setup. The same setup was also used in (Roark, 2001), (Chelba and Jelinek, 2000) and (Chelba and Xu, 2001). The size of the test set is 213 utterances, 3446 words. The 20k words open vocabulary and baseline 3-gram model are the standard ones provided by NIST and LDC — see (Chelba and Jelinek, 2000) for details. The lattices and N-best lists were generated using the standard 3-gram model trained on 45M words of WSJ. The N-best size was at most 50 for each utterance,","3","A parse is ready for completion when at the end of the sentence there are exactly two exposed headwords, the first of which if the start-of-sentence symbol and the second is an or-dinary word. See (Chelba and Jelinek, 2000) for details about special rules. and the average size was about 23. The SLM was trained on 20M words of WSJ text automatically parsed using the parser in (Ratnaparkhi, 1997), binarized and enriched with headwords and NT/POS tag information as explained in Section 2.2 and Section 3. Because SLM training on the 20M words of WSJ text is very expensive, especially after enriching the NT/POS tags, we only evaluated the WER performance of the seven models with initial statistics from binarized and enriched parse trees. The results are shown in Table 4. The table shows not only the results according to different interpolation weights  , but also the results corresponding to  ",", a virtual interpolation weight. We split the test data into two parts,  and",". The best interpolation","weight, estimated from part ",", was used to decode part",", and vice versa. We finally put the decoding results of the two parts together to get the final decoding output. The interpolation weight  ","is virtual because the best interpolation weights for the two parts might be different. Ideally, ","should be estimated from separate held-out data and then applied to the test data. However, since we have a small number of N-best lists, our approach should be a good estimate of the WER under the ideal interpolation weight.","As can be seen, the h-2+opposi